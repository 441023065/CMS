var PostViewModel,detailViewModel,listViewModel;PostViewModel=function(){function n(n){var t;this.isadmin=n,t=this,t.State=ko.observable("list"),t.listViewModel=ko.observable(new listViewModel),t.detailViewModel=ko.observable(new detailViewModel),t.authorized=n,$.sammy(function(){return this.get("#!//search/:query$",function(){var n;return n=this.params.query,t.listViewModel().turnpages("","",1,"search",n)}),this.get("#!/:group/:page/:type/:query/?$",function(){var n,i,r,u,f;return n=urlHelper.getChannelUrl(),i=this.params.group,r=this.params.page,f=this.params.type,u=this.params.query,t.listViewModel().turnpages(n,i,r,f,u)}),this.get("#!/:group/:type/:query/?$",function(){var n,i,r,u;return n=urlHelper.getChannelUrl(),i=this.params.group,u=this.params.type,r=this.params.query,t.listViewModel().turnpages(n,i,1,u,r)}),this.get("#!/:group/:page/?$",function(){var n,i,r;return n=urlHelper.getChannelUrl(),i=this.params.group,r=this.params.page,t.listViewModel().turnpages(n,i,r,"","")}),this.get("#!/:page/?$",function(){var i,n;return i=urlHelper.getChannelUrl(),n=this.params.page,IsNum(n)?t.listViewModel().turnpages(i,"",n,"",""):t.listViewModel().turnpages(i,n,1,"","")}),this.get("#!/?$",function(){var n;return n=urlHelper.getChannelUrl(),t.listViewModel().turnpages(n,"",1,"","")})}).run()}return n}(),listViewModel=function(){function n(){var n;n=this,n.list=ko.observableArray(),n.loading=ko.observable(!1),n.TotalResults=ko.observable(),n.Pager=ko.pager(n.TotalResults),n.channel=ko.observable(""),n.group=ko.observable(""),n.type=ko.observable(""),n.query=ko.observable(""),n.link=ko.computed(function(){var t,i,r,u,f;return t=n.channel(),i=n.group()?"/"+n.group():"",r=n.Pager().CurrentPage()!==1?"/"+n.Pager().CurrentPage():"",f=n.type()?+"self.type()/":"",u=n.query(),"/"+t+"#!"+i+r+"/"+f+u},n),n.request=ko.computed(function(){var t;return t="/article?",t+="type=list",t+="&channelurl="+n.channel(),t+="&groupurl="+n.group(),t+="&id="+n.Pager().CurrentPage(),n.type()!==""&&(t+="&"+n.type()+"="+n.query()),t},n),n.del=function(t){return Messenger().run({progressMessage:"Deleting data..."},{url:"/admin/postmanage/delete/",data:"id="+t.PostId,method:"post",dataType:"json",complete:function(i){var r;return r=JSON.parse(i.responseText),r.result?(""+message.success+"“#"+t.Title+"”  be moved to trash.",t.PostStatus="Trash",itemRefresh(n.list,t)):message.error(r.reason)}})},n.expand=function(t){return t.IsShowDetail=!t.IsShowDetail,itemRefresh(n.list,t),codeformat()},n.Pager().CurrentPage.subscribe(function(){return location.href=n.link()}),n.turnpages=function(t,i,r,u,f){return $(".dropdown.open .dropdown-toggle").dropdown("toggle"),n.channel(t),n.group(i),n.type(u),n.query(f),n.Pager().CurrentPage(r),n.loading(!n.loading()),scroll(0,0),$.getJSON(n.request(),function(t){return $("nav ul li.moving_bg").is(":animated")?setTimeout(function(){return n.refreshlist(t)},300):n.refreshlist(t)})},n.refreshlist=function(t){return n.loading(!n.loading()),n.list(t.data),n.TotalResults(t.count),ko.utils.arrayForEach(n.list(),function(n){return n.IsShowDetail=!1}),imglazyload("#posts")}}return n}(),detailViewModel=function(){}