@using YangKai.BlogEngine.Modules.PostModule.Objects

@{
    Layout = "~/Views/Shared/_layout-whth-sidebar.cshtml";
    var channel = ViewBag.Channel as Channel;
    var group = ViewBag.Group as Group;
    var isAdmin = YangKai.BlogEngine.Common.WebMasterCookie.IsLogin.ToString().ToLower();
}

@section scripts{
    <script>
        $(function () {
            if (window.location.href.indexOf('#!') == -1) {
                window.location.href = window.location.href + "#!";
            }
            ko.applyBindings(new ViewModel(@isAdmin), $("#posts")[0]);
        });
    </script>
}

<div id="posts">
    @*TODO 使用ko动态生成 *@
    <div class="breadcrumbs">
        <strong>@channel.Name</strong>
    </div>
    @if (YangKai.BlogEngine.Common.WebMasterCookie.IsLogin)
    {
        <div id="addpost" class="_add"><a href="/admin/postmanage/new">添加新文章</a></div>
        <div class="clear"></div>
    }
    <div data-bind="template: { name: 'post', data: $root }"></div>
</div>
