var ArticleDetailController=["$scope","$routeParams","Article","Comment",function(n,t,i,r){return n.$parent.showBanner=!1,n.loading=!0,n.url=t.url,i.get({$filter:"Url eq '"+n.url+"'"},function(t){var r,u,e,f;for(n.item=t.value[0],n.$parent.title=n.item.Title,codeformat(),n.loading=!1,n.entity.PostId=n.item.PostId,n.prevPost=i.nav({$filter:"CreateDate lt datetime'"+n.item.CreateDate+"' and Group/Url eq '"+n.item.Group.Url+"'",$orderby:"CreateDate desc"}),n.nextPost=i.nav({$filter:"CreateDate gt datetime'"+n.item.CreateDate+"' and Group/Url eq '"+n.item.Group.Url+"'",$orderby:"CreateDate"}),f=n.item.Comments,u=0,e=f.length;u<e;u++)r=f[u],r.Gravatar=r.Email?"http://www.gravatar.com/avatar/"+md5(r.Email):"/Content/img/avatar.png";return i.browsed({id:"(guid'"+n.item.PostId+"')"})}),n.entity={},n.entity.Author=n.User.UserName,n.entity.Email=n.User.Email,n.entity.Url=n.User.Url,n.AuthorForDisplay=n.User.UserName,n.editmode=n.User.UserName===""||!(n.User.UserName!=null),n.del=function(n){return r.del({id:n.CommentId},function(){return message.success("“#"+n.Content+"”  be moved to trash."),n.IsDeleted=!0},function(n){var t;return message.error((t=n.data.ExceptionMessage)!=null?t:n.status)})},n.renew=function(n){return r.renew({id:n.CommentId},function(){return message.success("“#"+n.Content+"”  be renew."),n.IsDeleted=!1},function(n){var t;return message.error((t=n.data.ExceptionMessage)!=null?t:n.status)})},n.save=function(){return n.submitting=!0,n.entity.CommentId=UUID.generate(),r.save(n.entity,function(t){return message.success("Comment has been submitted."),n.item.Comments.push(t),n.entity.Content="",n.AuthorForDisplay=t.Author,n.editmode=!1,angular.resetForm(n,"form"),n.submitting=!1,i.commented({id:"(guid'"+n.item.PostId+"')"})},function(n){var t;return message.error((t=n.data.ExceptionMessage)!=null?t:n.status)})}}]