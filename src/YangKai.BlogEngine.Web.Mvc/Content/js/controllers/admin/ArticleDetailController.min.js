var ArticleDetailController=["$scope","$routeParams","$window","Article","Channel",function(n,t,i,r,u){return n.id=t.id,n.entity={},n.thumbnail={},n.channels=u.query({$expand:"Groups,Groups/Categorys"}),n.getGroups=function(){var i,t,u,r;if(n.channels.value===void 0)return void 0;for(r=n.channels.value,t=0,u=r.length;t<u;t++)if(i=r[t],i.ChannelId===n.channelId)return i.Groups},n.getCategories=function(){var i,t,u,r;if(n.getGroups()===void 0)return void 0;for(r=n.getGroups(),t=0,u=r.length;t<u;t++)if(i=r[t],i.GroupId===n.groupId)return i.Categorys},n.submit=function(){var t,u,f,e,h,c,o,s;for(t=n.entity,t.PostId=UUID.generate(),t.Group={},t.Group.GroupId=function(){var t,f,i,r;for(i=n.getGroups(),r=[],t=0,f=i.length;t<f;t++)u=i[t],u.GroupId===n.groupId&&r.push(u);return r}()[0].GroupId,t.Categorys=[],o=n.getCategories(),f=0,h=o.length;f<h;f++)u=o[f],u.checked&&t.Categorys.push({CategoryId:u.CategoryId});if(t.Tags=[],n.tags)for(s=n.tags.split(","),e=0,c=s.length;e<c;e++)u=s[e],t.Tags.push({TagId:UUID.generate(),Name:u});return n.source&&(t.Source=n.source,t.Source.SourceId=UUID.generate()),t.Thumbnail=null,r.save(t,function(){return i.location.href="/#!/post/"+t.Url})}}]